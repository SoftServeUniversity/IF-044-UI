
<!DOCTYPE html>
<html lang="en">

<head>
    <!--<meta charset="utf-8">-->
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>YunakQuize Layout</title>

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <script src="json/data.json"></script>

</head>

<body class="container-fluid">
    <div id="outer-wrapper" class="container">
        <div id="inner-wrapper" class="container">
            <header class="row">
                <div id="header-container" class=" col-xs-12 col-sm-10 col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1 col-sm-offset-1  col-xs-offset-0">
                    <a href="#">
                        <img src="pic/logo.png" alt="YunakQuize">
                    </a>
                    <nav id="header-menu">
                        <ul>
                            <li>
                                <a href="#">Тести</a>
                            </li>
                            <li>
                                <a href="#">Про нас</a>
                            </li>
                            <li>
                                <a href="#">Контакти</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </header>
            <main>
                <div class="row">
                    <div class="input-group col-xs-12 col-lg-6 col-md-6 col-sm-6 col-xs-offset-0 col-lg-offset-4 col-md-offset-4  col-sm-offset-4">
                        <input type="text" class="form-control" id="search_input" placeholder="введіть шось для пошуку...">
                        <span class="input-group-btn">
                            <button class="btn btn-info" type="button">пошук</button>
                        </span>
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="col-xs-12 col-lg-4 col-md-4 col-sm-4">
                        <style>
                            .filter-title {
                                font-size: 24px;
                                color: #428bca;
                            }
                            .reset {
                                color: #428bca;
                            }
                            label {
                                margin: 0;
                                font-weight: normal;
                            }
                        </style>
                        <div class="row filter-search">
                            <div class="col-xs-8 col-xs-offset-2">
                                <span class="reset">
            <img src="pic/reset.png" height="10" width="10"> шукати скрізь</span>
                            </div>
<!--
                            <div class="col-xs-12">
                                <div class=" col-xs-8 col-xs-offset-2 text-left name-category">категорія 1</div>
                                <div class="row">
                                    <div class="col-xs-8 col-xs-offset-1 text-center">
                                        підкатегорія
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-8 col-xs-offset-1 text-center">
                                        підкатегорія
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-8 col-xs-offset-1 text-center">
                                        підкатегорія
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12">
                                <div class=" col-xs-8 col-xs-offset-2 text-left name-category ">категорія 1</div>
                                <div class="row">
                                    <div class="col-xs-8 col-xs-offset-1 text-center curent-filter">
                                        підкатегорія
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-8 col-xs-offset-1 text-center curent-filter">
                                        підкатегорія
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-8 col-xs-offset-1 text-center curent-filter">
                                        підкатегорія
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12">
                                <div class=" col-xs-8 col-xs-offset-2 text-left name-category">категорія 1</div>
                                <div class="row">
                                    <div class="col-xs-8 col-xs-offset-1 text-center">
                                        підкатегорія
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-8 col-xs-offset-1 text-center">
                                        підкатегорія
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-8 col-xs-offset-1 text-center">
                                        підкатегорія
                                    </div>
                                </div>
                            </div>
-->

                        </div>
                    </div>
                    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

                    <div class="col-xs-12 col-lg-8 col-md-8 col-sm-8">
                        <style>
                            .search-result {
                                border: solid 2px transparent;
                                padding: 0 19px;
                                -moz-transition: all .2s linear 0.1s;
                                /*                                transition-timing-function: steps(0.8) */
                                -webkit-transition: all .8s linear 0.1s;
                                -o-transition: all .2s linear 0.1s;
                                transition: all .2s linear 0.1s;
                            }
                            .search-result:hover {
                                border: solid 2px rgb(221, 219, 219);
                                box-shadow: 0 3px 6px rgba(0, 0, 0, .6);
                                border-radius: 5px;
                            }
                            .filter-search > div {
                                color: #5bc0de;
                                cursor: pointer;
                                /*                                border-right:solid 2px blue; ; */
                            }
                            .curent-filter {
                                font-weight: bold;
                                border-right: solid 3px;
                            }
                            .search-tag {
                                list-style: none;
                            }
                            .search-teg li {
                                display: inline-block;
                            }
                        </style>
                        <div class="row row-search-result">                       
<script>




var place_for_filter = document.querySelectorAll('.filter-search')[0];
var content = '';
var list_categories = [];
for(var i = 0;i<Categories.length;i++){
if(Categories[i].parent_id == 0){
    list_categories.push({name:Categories[i].name,id: Categories[i].id}); 
}
}
for(var i = 0;i<list_categories.length;i++){
    content +='<div class="col-xs-12"><div class=" col-xs-8 col-xs-offset-2 text-left name-category">'+list_categories[i].name+'</div>';
    for(var j = 0;j<Categories.length;j++){
    if(Categories[j].parent_id == list_categories[i].id){
       content +='<div class="row"><div class="col-xs-8 col-xs-offset-1 text-center" sub_categ ="'+Categories[j].id+'"  categ ="'+Categories[j].parent_id+'">                                        '+Categories[j].name+'</div></div>';        
    }
    }
     content += '</div>';
}
     place_for_filter.innerHTML += content;








/////////////////////////////////////////////////////////////////////////////////////////
var row_results = document.querySelectorAll(".row-search-result")[0];
showEmpty = function(){
    row_results.innerHTML = '';
}
showAllcontaining = function(value, category, sub_category){
        var filter = false;                
        if(sub_category && category){
            filter = true;
        }
        console.log(Tests);      
        var result_array = [];
        for(index in Tests){
            for(inner_index in Tests[index]){
                if(filter){
                    if(typeof Tests[index][inner_index]!= 'number' && Tests[index][inner_index].toString().toLowerCase().indexOf(value.toLowerCase()) + 1 && sub_category.indexOf(Tests[index]['subcategory'].toString())+1 && category.indexOf(Tests[index]['category'].toString())+1){
                        result_array.push(index);
                        break;
                    }
                }else{
                    if(typeof Tests[index][inner_index]!= 'number' && Tests[index][inner_index].toString().toLowerCase().indexOf(value.toLowerCase()) + 1){
                        result_array.push(index);
                        break;
                    }                
                }
            }
        }
      console.log(result_array);
      if(result_array.length){
      for(ind in result_array){
        var i = result_array[ind];
        var tags = '';
        for(var j = 0;j<Tests[i].tags.length;j++){
            if(j!=Tests[i].tags.length-1 ){
                tags += '<li><a href="">' + Tests[i].tags[j] + '&nbsp|</a></li> ';
            }else{
               tags += '<li><a href="">' + Tests[i].tags[j] + '</a></li>'; 
            }
        }
        row_results.innerHTML += '                            <div class="col-xs-12 col-sm-9 col-md-9 col-lg-9 search-result well">                                <h3 class="title-post-name">          <a style="text-decoration: none;" href="#">'+Tests[i].name+'</a>                              </h3>                                <p class="text-justify ">'+Tests[i].descr+'</p><div class="col-xs-12"><ul class="search-teg">'+tags+' </ul>                                </div></div>';          
      }  
        } else{
           showEmpty(); 
        }     				
}								


var search_input = document.getElementById('search_input');
				search_input.addEventListener('keyup',function(){
					showEmpty(); 
					var value = search_input.value;
					var cat = false;
					var subcat = false;
					var array_filter_categories = document.querySelectorAll('.curent-filter');
					if(array_filter_categories.length){
					    cat = [];
					    subcat = [];
					    for(var i =0;i<array_filter_categories.length;i++){
					         if(cat.indexOf(array_filter_categories[i].getAttribute("categ")) == -1){
					             cat.push(array_filter_categories[i].getAttribute("categ"));
					         }
					         subcat.push(array_filter_categories[i].getAttribute("sub_categ"));
					    }
					}else{
						 cat = false;
					     subcat = false;
					}
					console.clear();
					console.log(cat);
					console.log(subcat);
					if(value.replace(/^\s+|\s+$/g, '') === ''){
                        showEmpty();
					} else {
						showAllcontaining(value,cat,subcat);
					}
				});

</script>
                    <script>
                        $('.name-category').on('click',function () {
                           // alert('d');
                            if($(this).siblings().find('div').hasClass('curent-filter')){
                            console.log('true');
                           // $('.curent-filter').removeClass('curent-filter');
                             console.log($(this).siblings().find('div'));
                             $(this).siblings().find('div').removeClass('curent-filter');
                            }else{
                                //$(this).addClass('curent-filter');
                                $(this).siblings().find('div').addClass('curent-filter');
                            }
                        })
                         $('.name-category').siblings().find('div').click(function(){
                             if($(this).hasClass('curent-filter')){
                                 $(this).removeClass('curent-filter');
                             }else{
                                  $(this).addClass('curent-filter');
                             }
                         });
                         $('.reset').click(function () {
                            //console.log($('this').children());
                            // $('input[type=checkbox]').attr('checked','checked');
                            $('.curent-filter').removeClass('curent-filter');
                            $('input[type=checkbox]').prop('checked', false);
                        });
                    </script>
                        </div>
                    </div>
                </div>

                <!--                CONTENT!!!-->

            </main>
        </div>
    </div>
    <footer class="container">
        <div id="footer-container">
            <nav id="footer-menu">
                <ul>
                    <li>
                        <a href="#">Тести &nbsp|</a>
                    </li>
                    <li>
                        <a href="#">Про нас &nbsp|</a>
                    </li>
                    <li>
                        <a href="#">Контакти</a>
                    </li>
                </ul>
            </nav>
            <p>Copyright@ 2014
                <b>IF-044</b>
            </p>
        </div>
    </footer>


    <script src="js/bootstrap.min.js"></script>
</body>

</html>
