<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>YunakQuize Layout</title>

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <script src="json/data.json"></script>

</head>

<body class="container-fluid">
    <div id="outer-wrapper" class="container">
        <div id="inner-wrapper" class="container">
            <header class="row">
                <div id="header-container" class=" col-xs-12 col-sm-10 col-md-10 col-lg-10 col-lg-offset-1 col-md-offset-1 col-sm-offset-1  col-xs-offset-0">
                    <a href="#">
                        <img src="pic/logo.png" alt="YunakQuize">
                    </a>
                    <nav id="header-menu">
                        <ul>
                            <li>
                                <a href="#">Тести</a>
                            </li>
                            <li>
                                <a href="#">Про нас</a>
                            </li>
                            <li>
                                <a href="#">Контакти</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </header>
            <main>
<div class="row">
    <div class="col-lg-7 col-lg-offset-1 content-test">
<script>
//var place_for_filter = document.querySelectorAll('.filter-search')[0];
//var content = '';
//var list_categories = [];
//for(var i = 0;i<Categories.length;i++){
//if(Categories[i].parent_id == 0){
//    list_categories.push({name:Categories[i].name,id: Categories[i].id}); 
//}
//}
//for(var i = 0;i<list_categories.length;i++){
//    content +='<div class="col-xs-12"><div class=" col-xs-8 col-xs-offset-2 text-left name-category">'+list_categories[i].name+'</div>';
//    for(var j = 0;j<Categories.length;j++){
//    if(Categories[j].parent_id == list_categories[i].id){
//       content +='<div class="row"><div class="col-xs-8 col-xs-offset-1 text-center" sub_categ ="'+Categories[j].id+'"  categ ="'+Categories[j].parent_id+'">                                        '+Categories[j].name+'</div></div>';        
//    }
//    }
//     content += '</div>';
//}
//     place_for_filter.innerHTML += content;    
    
    
    var place_for_test = document.querySelectorAll('.content-test')[0];
    var content = '';
    content += '<h3 class="title-post-name col-xs-12 edit-content testDouble" style="float: none">'+Tests[0].name+'</h3>';
    var number_question = 0;
        for(var i = 0;i<Tests[0].question.length;i++){
        var number_answer = 0;
        number_question++;
        var question_id = Tests[0].question[i].id 
        content+='<div class="row well"><div class="col-lg-12 text-justify testDouble">'+number_question+'. '+Tests[0].question[i].text+'</div>';
        for(var j = 0;j<Tests[0].answers.length;j++){
             number_answer++;
             if(Tests[0].answers[j].question_id == question_id){
                 content+= '<div class="col-lg-10 col-lg-offset-2 text-justify testDouble">'+number_answer+') '+Tests[0].answers[j].text_answer+'</div>';
             }
        }
    content += '</div>';
    }
    place_for_test.innerHTML += content;
    //console.log(content);
</script>                          
    </div>
    <script>
        //var content_for_edit = document.querySelectorAll('.edit-content');




//create function, it expects 2 values.
function insertAfter(newElement,targetElement) {
	//target is what you want it to go after. Look for this elements parent.
	var parent = targetElement.parentNode;
 
	//if the parents lastchild is the targetElement...
	if(parent.lastchild == targetElement) {
		//add the newElement after the target element.
		parent.appendChild(newElement);
		} else {
		// else the target has siblings, insert the new element between the target and it's next sibling.
		parent.insertBefore(newElement, targetElement.nextSibling);
		}
}
        
                
                        
                                
                                                
        var content_for_edit = document.querySelectorAll('.testDouble');
        for(var i = 0;i<content_for_edit.length;i++){
            content_for_edit[i].addEventListener('dblclick', function(){
                 //console.log(this.textContent);
                 //console.log(this);
                // console.log(editText);
                var that = this;
                var editText = document.createElement('textarea')
                    editText.rows = '4';
                    editText.cols = "60";
                    editText.className = 'edit-textarea';

                    editText.textContent = this.textContent;
                    console.log(editText);
                   insertAfter(editText, this);
                    function saveChange(){
                       console.log(window.event);
                       console.log(document.querySelectorAll('.edit-textarea')[0]);
                       var changeText = document.querySelectorAll('.edit-textarea')[0].value;
                       if(window.event.srcElement.className!=='edit-textarea'){
                           document.querySelectorAll('.edit-textarea')[0].parentNode.removeChild(document.querySelectorAll('.edit-textarea')[0]);
                           that.textContent = changeText;
                           document.querySelectorAll('body')[0].removeEventListener('click',saveChange);
                       //console.log(that);
                       }
                   }                   
                   document.querySelectorAll('body')[0].addEventListener('click',saveChange);
                   
            });
            
        }
       
    </script>
    <div class="col-lg-3">
        <h3 class="title-post-name col-xs-12">Коментарі</h3>
        <div class="row">
            <div class="col-lg-10 col-lg-offset-1 well place_for_comment">
                <div class="col-lg-10 text-justify">ше шось... </div>
                <div class="col-xs-12 form-group">
                <script>
                    function addComment(e){
                        var comment = e.querySelectorAll('textarea')[0].value;
                         aaa = e;
                        console.log(e.parentNode);
                        //parentElem.insertBefore(newDiv, parentElem.firstChild);
                        //e.parentNode.parentNode.innerHTML += '<div class="col-lg-10 text-justify">'+comment+'</div>';
                       // comment = '<div class="col-lg-10 text-justify">'+comment+'</div>';
                        var newDiv = document.createElement('div');
                        newDiv .className = "col-lg-10 text-justify";
                        newDiv.innerHTML = comment;
                        document.querySelectorAll('.place_for_comment')[0].insertBefore(newDiv, e.parentNode);
                        
                        //console.log(e.querySelectorAll('textarea')[0].value());
                    }
                </script>       
                <form action="" id="add-comment" onsubmit="addComment(this);return false;">
                <textarea class="form-control" rows="4">hello world</textarea><br>
                     <input type="submit" class="btn btn-primary btn-mini" value="добавити коментар">
                </form>  
                </div>
            </div>
        </div>
    </div>
</div>
            <div class="row">
                                <button type="button" class="btn btn-success">затвердити</button>
                                <button type="button" class="btn btn-danger">завернути</button>
            </div>
            </main>
        </div>
    </div>
    <footer class="container">
        <div id="footer-container">
            <nav id="footer-menu">
                <ul>
                    <li>
                        <a href="#">Тести &nbsp|</a>
                    </li>
                    <li>
                        <a href="#">Про нас &nbsp|</a>
                    </li>
                    <li>
                        <a href="#">Контакти</a>
                    </li>
                </ul>
            </nav>
            <p>Copyright@ 2014
                <b>IF-044</b>
            </p>
        </div>
    </footer>  

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
</body>

</html>
